<div id="loader-container" class="loader"></div>
<div id="advertisement"></div>
<div id="categories00"></div>

<script>
  /**
   * @file pages/home.html
   * @description Main Home Page. Loads advertisements and categories dynamically.
   */

  // This code is executed after the full page content is loaded to ensure all DOM elements are available.
  async function main() {
    // Determine key elements on the page: leading indicator and content containers.
    const loaderElement = document.getElementById("loader-container");
    const contentElements = [
      document.getElementById("advertisement"),
      document.getElementById("categories00"),
    ];
    // To store the original display state of elements before hiding them.
    const originalDisplays = new Map();

    // Step 1: Hide main content and show loading indicator to improve user experience.
    contentElements.forEach((el) => {
      originalDisplays.set(el, el.style.display || ""); // Save original display state.
      el.style.display = "none";
    });
    loaderElement.style.display = "block";

    // Step 2: Load content of different parts (ads and categories) synchronously.
    // Promise.all is used to ensure all parts are loaded before proceeding.
    await Promise.all([
      loader("../pages/advertisement.html", "advertisement", 0),
      loader("../pages/categories.html", "categories00", 300),
    ]);

    // Step 3: After content loading, initialize modules responsible for each part's functionality.
    // Initialize Advertisement Module.
    initAdverModule(document.getElementById("advertisement-section"));
    // Load and display categories.
    categories_loadCategoriesAsTable(); // Assume this function appends content to hidden elements.

    // Step 4: After loading and initialization are complete, show content and hide loading indicator.
    contentElements.forEach(
      (el) => (el.style.display = originalDisplays.get(el))
    );
    loaderElement.style.display = "none";

  } main();
</script>