# تفاصيل نوافذ مراحل الطلب (Stepper Popups Details)

يوضح الجدول التالي تفاصيل الرسائل (النوافذ المنبثقة) السبعة التي تظهر خلال مراحل معالجة الطلب، موضحاً محتواها، صلاحيات التعديل، دورها، ومن يمكنه مشاهدتها.

| # | الرسالة / المرحلة | المحتوى (Content) | من يمكنه التعديل (Edit Permission) | الدور / الوظيفة (Role/Function) | من يمكنه المشاهدة (View Permission) | معرف الحاوية (Popup ID) | عنوان النافذة (Popup Title) |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **1** | **مراجعة الطلب (Review)** | قائمة بجميع منتجات الطلب مع مربعات اختيار (Checkboxes) مفعلة افتراضياً. | **المحتوى:** المشتري فقط.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للمشتري:** مراجعة المنتجات وتحديد ما يريد شراؤه فعلياً، وإلغاء ما لا يريده (بإزالة التحديد). | • المشتري<br>• البائع (قراءة فقط)<br>• الأدمن | `buyer-review-products-container` | اختر المنتجات / عرض المنتجات |
| **2** | **تأكيد الطلب (Confirmed)** | قائمة بالمنتجات التي اختارها المشتري، مع خيارات لتأكيد توفرها، **ويظهر اسم مندوب التوصيل المرتبط**. | **المحتوى:** البائع فقط.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للبائع:** تأكيد توفر المنتجات والبدء في تجهيزها، أو رفض المنتجات غير المتوفرة. | • البائع<br>• المشتري (قراءة فقط)<br>• الأدمن | `seller-confirmation-container` (البائع)<br>`buyer-confirmed-container` (المشتري) | تأكيد المنتجات (بائع)<br>المنتجات المؤكدة (مشتري) |
| **3** | **تم الشحن (Shipped)** | نموذج لإدخال بيانات الشحن (اسم المندوب، رقم الهاتف) وقائمة المنتجات الجاهزة للشحن. | **المحتوى:** البائع، مندوب التوصيل.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للبائع/المندوب:** تسجيل خروج الطلب للتوصيل وتحديد من سيقوم بالتوصيل. | • البائع<br>• مندوب التوصيل<br>• المشتري (قراءة فقط)<br>• الأدمن | `seller-shipping-container` (البائع)<br>`buyer-shipping-container` (المشتري) | شحن المنتجات (بائع)<br>منتجات قيد الشحن (مشتري) |
| **4** | **تم التوصيل (Delivered)** | قائمة بالمنتجات المشحونة لتأكيد استلامها. (بيانات المشتري مخفية عن البائع). | **المحتوى:** المشتري، مندوب التوصيل.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للمشتري:** تأكيد استلام المنتجات بحالة جيدة، أو إرجاعها (بإزالة التحديد). | • المشتري<br>• مندوب التوصيل<br>• البائع (قراءة فقط)<br>• الأدمن | `delivery-confirmation-container` (المشتري)<br>`seller-delivery-container` (البائع) | تأكيد استلام المنتجات (مشتري)<br>تأكيد استلام المنتجات (قراءة فقط) (بائع) |
| **5** | **ملغي (Cancelled)** | قائمة بالمنتجات التي قام **المشتري** بإلغائها في مرحلة "مراجعة الطلب". | **لا أحد** (قراءة فقط).<br>(يمكن التراجع عنها فقط عبر إعادة تحديدها في مرحلة المراجعة). | عرض المنتجات التي لم يرغب المشتري في إكمال شرائها. | • المشتري<br>• البائع<br>• الأدمن<br>• مندوب التوصيل (المرتبط) | `cancelled-products-container` | المنتجات الملغاة |
| **6** | **مرفوض (Rejected)** | قائمة بالمنتجات التي قام **البائع** برفضها (عدم توفرها) في مرحلة "تأكيد الطلب". | **لا أحد** (قراءة فقط).<br>(يمكن التراجع عنها فقط عبر إعادة تأكيدها في مرحلة التأكيد). | إعلام المشتري والأطراف الأخرى بالمنتجات التي لا يمكن توفيرها. | • البائع<br>• المشتري<br>• الأدمن<br>• مندوب التوصيل (المرتبط) | `seller-rejected-container` (البائع)<br>`buyer-rejected-container` (المشتري) | المنتجات المرفوضة |
| **7** | **مرتجع (Returned)** | قائمة بالمنتجات التي قام **المشتري** بإرجاعها (عدم استلامها) في مرحلة "تم التوصيل". | **لا أحد** (قراءة فقط).<br>(يمكن التراجع عنها فقط عبر إعادة تأكيد استلامها في مرحلة التوصيل). | توثيق المنتجات التي وصلت للمشتري ولكن قرر إعادتها مع المندوب. | • المشتري<br>• البائع<br>• مندوب التوصيل<br>• الأدمن | `buyer-returned-container` (المشتري)<br>`seller-returned-container` (البائع) | المنتجات المرتجعة (مشتري)<br>المنتجات المرتجعة (قراءة فقط) (بائع) |

## دورة حياة المراحل وآلية التفعيل/الاسترجاع

يوضح الجدول التالي كيفية تفعيل كل مرحلة، ومن المسؤول عنها، وكيفية التراجع عن الحالة (إعادة التعيين):

| المرحلة | التفعيل (Activate) | طريقة التفعيل | إعادة التعيين (Reset) | طريقة إعادة التعيين | ملاحظات |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **مراجعة (Review)** | **المشتري** | تحديد المنتج في القائمة وحفظ الاختيارات. (يتحول لـ Pending) | **المشتري** | إلغاء تحديد المنتج وحفظ الاختيارات. (يتحول لـ Cancelled) | إلغاء التحديد هنا هو الطريقة الوحيدة "لإلغاء" المنتج. |
| **تأكيد (Confirmed)** | **البائع** | تحديد المنتج وحفظ. (يتحول لـ Confirmed) | **البائع** | إلغاء تحديد المنتج وحفظ. (يعود لـ Pending) | المنتج غير المحدد يظهر كـ "معلق" (Pending) وليس "مرفوض" في هذه المرحلة إلا بإجراء خاص. |
| **الشحن (Shipped)** | **البائع/المندوب** | تحديد المنتج (مع اختيار مندوب) وحفظ. (يتحول لـ Shipped) | **البائع/المندوب** | إلغاء تحديد المنتج وحفظ. (يعود لـ Confirmed) | لا يمكن الشحن بدون تحديد بيانات المندوب. |
| **التوصيل (Delivered)** | **المشتري/المندوب** | تحديد المنتج وحفظ. (يتحول لـ Delivered) | **المشتري/المندوب** | إلغاء تحديد المنتج وحفظ. (يعود لـ Shipped) | تأكيد نهائي على استلام المنتج وانتقال المسؤولية. |
| **ملغي (Cancelled)** | **تلقائي** | عن طريق إلغاء المشتري للمنتج في مرحلة "مراجعة". | **المشتري** | إعادة تحديد المنتج في مرحلة "مراجعة". | لا يمكن التراجع عن الإلغاء من نافذة الإلغاء نفسها، بل بالعودة للمراجعة. |
| **مرفوض (Rejected)** | **يدوي/خاص** | تحويل حالة المنتج إلى مرفوض (غالباً لإجراءات عدم التوفر). | **البائع** | إعادة تأكيده في مرحلة "تأكيد" (إذا أتيح). | تظهر هذه النافذة للعرض فقط ولا تحوي أزرار تحكم مباشرة في الواجهة الحالية. |
| **مرتجع (Returned)** | **يدوي/خاص** | تحويل حالة المنتج إلى مرتجع بعد التوصيل. | **المشتري/المندوب** | إعادة تأكيد استلامه في "التوصيل". | تظهر هذه النافذة للعرض فقط وتوثيق المرتجعات. |
