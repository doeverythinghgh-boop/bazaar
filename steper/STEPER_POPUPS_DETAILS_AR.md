# تفاصيل نوافذ مراحل الطلب (Stepper Popups Details)

يوضح الجدول التالي تفاصيل الرسائل (النوافذ المنبثقة) السبعة التي تظهر خلال مراحل معالجة الطلب، موضحاً محتواها، صلاحيات التعديل، دورها، ومن يمكنه مشاهدتها.

| # | الرسالة / المرحلة | المحتوى (Content) | من يمكنه التعديل (Edit Permission) | الدور / الوظيفة (Role/Function) | من يمكنه المشاهدة (View Permission) | معرف الحاوية (Popup ID) | عنوان النافذة (Popup Title) |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **1** | **مراجعة الطلب (Review)** | قائمة بجميع منتجات الطلب مع مربعات اختيار (Checkboxes) مفعلة افتراضياً. | **المحتوى:** المشتري فقط.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للمشتري:** مراجعة المنتجات وتحديد ما يريد شراؤه فعلياً، وإلغاء ما لا يريده (بإزالة التحديد). | • المشتري<br>• البائع (قراءة فقط)<br>• الأدمن | `buyer-review-products-container` | اختر المنتجات / عرض المنتجات |
| **2** | **تأكيد الطلب (Confirmed)** | قائمة بالمنتجات التي اختارها المشتري، مع خيارات لتأكيد توفرها، **ويظهر اسم مندوب التوصيل المرتبط**. | **المحتوى:** البائع فقط.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للبائع:** تأكيد توفر المنتجات والبدء في تجهيزها، أو رفض المنتجات غير المتوفرة. | • البائع<br>• المشتري (قراءة فقط)<br>• الأدمن | `seller-confirmation-container` (البائع)<br>`buyer-confirmed-container` (المشتري) | تأكيد المنتجات (بائع)<br>المنتجات المؤكدة (مشتري) |
| **3** | **تم الشحن (Shipped)** | نموذج لإدخال بيانات الشحن (اسم المندوب، رقم الهاتف) وقائمة المنتجات الجاهزة للشحن. | **المحتوى:** البائع، مندوب التوصيل.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للبائع/المندوب:** تسجيل خروج الطلب للتوصيل وتحديد من سيقوم بالتوصيل. | • البائع<br>• مندوب التوصيل<br>• المشتري (قراءة فقط)<br>• الأدمن | `seller-shipping-container` (البائع)<br>`buyer-shipping-container` (المشتري) | شحن المنتجات (بائع)<br>منتجات قيد الشحن (مشتري) |
| **4** | **تم التوصيل (Delivered)** | قائمة بالمنتجات المشحونة لتأكيد استلامها. (بيانات المشتري مخفية عن البائع). | **المحتوى:** المشتري، مندوب التوصيل.<br>**الأدمن:** يمتلك صلاحية تجاوز للتعديل. | **للمشتري:** تأكيد استلام المنتجات بحالة جيدة، أو إرجاعها (بإزالة التحديد). | • المشتري<br>• مندوب التوصيل<br>• البائع (قراءة فقط)<br>• الأدمن | `delivery-confirmation-container` (المشتري)<br>`seller-delivery-container` (البائع) | تأكيد استلام المنتجات (مشتري)<br>تأكيد استلام المنتجات (قراءة فقط) (بائع) |
| **5** | **ملغي (Cancelled)** | قائمة بالمنتجات التي قام **المشتري** بإلغائها في مرحلة "مراجعة الطلب". | **لا أحد** (قراءة فقط).<br>(يمكن التراجع عنها فقط عبر إعادة تحديدها في مرحلة المراجعة). | عرض المنتجات التي لم يرغب المشتري في إكمال شرائها. | • المشتري<br>• البائع<br>• الأدمن<br>• مندوب التوصيل (المرتبط) | `cancelled-products-container` | المنتجات الملغاة |
| **6** | **مرفوض (Rejected)** | قائمة بالمنتجات التي قام **البائع** برفضها (عدم توفرها) في مرحلة "تأكيد الطلب". | **لا أحد** (قراءة فقط).<br>(يمكن التراجع عنها فقط عبر إعادة تأكيدها في مرحلة التأكيد). | إعلام المشتري والأطراف الأخرى بالمنتجات التي لا يمكن توفيرها. | • البائع<br>• المشتري<br>• الأدمن<br>• مندوب التوصيل (المرتبط) | `seller-rejected-container` (البائع)<br>`buyer-rejected-container` (المشتري) | المنتجات المرفوضة |
| **7** | **مرتجع (Returned)** | قائمة بالمنتجات التي قام **المشتري** بإرجاعها (عدم استلامها) في مرحلة "تم التوصيل". | **لا أحد** (قراءة فقط).<br>(يمكن التراجع عنها فقط عبر إعادة تأكيد استلامها في مرحلة التوصيل). | توثيق المنتجات التي وصلت للمشتري ولكن قرر إعادتها مع المندوب. | • المشتري<br>• البائع<br>• مندوب التوصيل<br>• الأدمن | `buyer-returned-container` (المشتري)<br>`seller-returned-container` (البائع) | المنتجات المرتجعة (مشتري)<br>المنتجات المرتجعة (قراءة فقط) (بائع) |

## دورة حياة المراحل وآلية التفعيل/الاسترجاع

يوضح الجدول التالي التفاصيل التقنية والوظيفية لكل مرحلة:

| المرحلة | رمز الحالة (Status Code) | المسؤول | التفعيل (Activate) | متطلبات التفعيل | إعادة التعيين (Reset) | التأثير (Impact) | ملاحظات |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| **مراجعة (Review)** | `ITEM_STATUS.PENDING` | **المشتري** | تحديد المنتج وحفظ. | لا يوجد. | **المشتري**: إلغاء التحديد وحفظ (يتحول لـ Cancelled). | يظهر المنتج للبائع في مرحلة "تأكيد الطلب". | الحالة الافتراضية عند فتح الطلب. |
| **تأكيد (Confirmed)** | `ITEM_STATUS.CONFIRMED` | **البائع** | تحديد المنتج وحفظ. | لا يوجد. | **البائع**: إلغاء التحديد وحفظ (يعود لـ Pending). | ينتقل المنتج لقائمة الشحن؛ يظهر للمشتري "مؤكد". | المنتج غير المحدد يبقى "معلق" (Pending). |
| **الشحن (Shipped)** | `ITEM_STATUS.SHIPPED` | **البائع/المندوب** | تحديد المنتج وحفظ. | **إجباري**: تحديد اسم المندوب ورقم الهاتف. | **البائع/المندوب**: إلغاء التحديد وحفظ (يعود لـ Confirmed). | يظهر للمشتري أن المنتج "تم شحنه"؛ يظهر في قائمة التوصيل. | لا يمكن تفعيل الشحن دون بيانات المندوب. |
| **التوصيل (Delivered)** | `ITEM_STATUS.DELIVERED` | **المشتري/المندوب** | تحديد المنتج وحفظ. | لا يوجد. | **المشتري/المندوب**: إلغاء التحديد وحفظ (يعود لـ Shipped). | يعتبر الطلب مكتملاً لهذا المنتج؛ يظهر في نافذة المرتجعات. | تأكيد نهائي على الاستلام. |
| **ملغي (Cancelled)** | `ITEM_STATUS.CANCELLED` | **تلقائي** | إلغاء المشتري للمنتج في "المراجعة". | لا يوجد. | **المشتري**: إعادة تحديد المنتج في "المراجعة". | يختفي من قوائم البائع الفعالة؛ يظهر في نافذة "ملغي". | يتم الوصول له عبر نافذة خاصة (Cancelled Popup). |
| **مرفوض (Rejected)** | `ITEM_STATUS.REJECTED` | **يدوي/خاص** | تحويل مباشر للحالة (Logic). | عدم توفر المنتج. | **البائع**: إعادة تأكيده في "تأكيد" (إذا أتيح). | يظهر للمشتري والمندوب أن المنتج مرفوض. | يتم الوصول له عبر نافذة خاصة (Rejected Popup). |
| **مرتجع (Returned)** | `ITEM_STATUS.RETURNED` | **يدوي/خاص** | تحويل مباشر للحالة (Logic). | رفض الاستلام بعد الشحن. | **المشتري/المندوب**: إعادة تأكيد استلامه في "التوصيل". | يظهر للبائع والمندوب كمنتج مرتجع. | يتم الوصول له عبر نافذة خاصة (Returned Popup). |
