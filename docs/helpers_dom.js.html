<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: helpers/dom.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: helpers/dom.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file js/helpers/dom.js
 * @description يوفر دوال مساعدة للتعامل مع عناصر DOM، مثل إعداد النوافذ المنبثقة (Modals) وتوليد HTML لبطاقات المنتجات والمستخدمين.
 */

/**
 * @description معرف الفئة التي لا تتطلب تحديد سعر أو كمية (تُستخدم للخدمات).
 * @type {string}
 * @const
 */
const SERVICE_CATEGORY_NoPrice_ID = "6";

/**
 * @description إعداد منطق النافذة المنبثقة (Modal) بشكل معياري.
 *   تنشئ وتدير دورة حياة نافذة منبثقة، وتتولى إظهار وإخفاء النافذة،
 *   وإضافة وإزالة فئة `modal-open` من الجسم، وربط أحداث الإغلاق
 *   (زر الإغلاق والنقر على الخلفية).
 * @function setupModalLogic
 * @param {string} modalId - معرف (ID) حاوية النافذة المنبثقة.
 * @param {string} closeBtnId - معرف (ID) زر الإغلاق داخل النافذة.
 * @param {object} [options={}] - خيارات إضافية.
 * @param {function(): void} [options.onClose] - دالة رد اتصال اختيارية يتم استدعاؤها عند إغلاق النافذة.
 * @returns {{open: function(): void, close: function(): void, modalElement: HTMLElement}|null} - كائن يحتوي على دوال الفتح والإغلاق وعنصر النافذة، أو `null` إذا لم يتم العثور على عنصر النافذة.
 */
function setupModalLogic(modalId, closeBtnId, options = {}) {
  const modalElement = document.getElementById(modalId);
  if (!modalElement) {
    console.error(`[Modal Logic] لم يتم العثور على عنصر النافذة بالمعرف: ${modalId}`);
    return null;
  }

  const close = () => {
    modalElement.style.display = "none";
    document.body.classList.remove("modal-open");
    if (typeof options.onClose === "function") {
      options.onClose();
    }
  };

  const open = () => {
    modalElement.style.display = "block";
    document.body.classList.add("modal-open");

    // ✅ إصلاح: ربط حدث الإغلاق بالزر والخلفية بشكل صحيح
    const closeBtn = document.getElementById(closeBtnId);
    if (closeBtn) closeBtn.onclick = close;

    // ربط حدث النقر على النافذة نفسها (الخلفية)
    modalElement.onclick = (event) => {
      if (event.target === modalElement) close();
    };
  };

  return { open, close, modalElement };
}

/**
 * @description تحميل وعرض نافذة منبثقة من قالب HTML.
 * @function loadAndShowModal
 * @param {string} modalId - معرف حاوية النافذة المنبثقة.
 * @param {string|null} templatePath - مسار ملف القالب HTML المراد تحميله (إذا كان `null`، يفترض أن الهيكل موجود بالفعل).
 * @param {function(HTMLElement): void} initCallback - دالة رد نداء تُستدعى بعد تحميل المحتوى وفتح النافذة، لتجهيز المنطق الخاص بها. تستقبل عنصر الـ modal كمعامل.
 * @param {function(): void} [onCloseCallback] - دالة رد نداء اختيارية تُستدعى عند إغلاق النافذة المنبثقة.
 * @returns {Promise&lt;void>} - وعد (Promise) لا يُرجع قيمة عند الاكتمال.
 * @see setupModalLogic
 */
async function loadAndShowModal(modalId, templatePath, initCallback, onCloseCallback) {
  const modal = document.getElementById(modalId);
  if (!modal) {
    console.error(`[Modal Loader] لم يتم العثور على حاوية النافذة: ${modalId}`);
    return;
  }

  const modalLogic = setupModalLogic(modalId, `${modalId}-close-btn`, { onClose: onCloseCallback });

  try {
    // تحميل المحتوى فقط إذا لم يكن موجودًا أو تم تحديد مسار
    if (templatePath &amp;&amp; modal.children.length === 0) {
      const response = await fetch(templatePath);
      if (!response.ok) throw new Error(`فشل تحميل القالب: ${response.status}`);
      modal.innerHTML = await response.text();

      // تنفيذ أي سكربتات مضمنة
      modal.querySelectorAll("script").forEach(script => {
        const newScript = document.createElement("script");
        newScript.textContent = script.textContent;
        document.body.appendChild(newScript).remove();
      });
    }

    modalLogic.open();
    if (typeof initCallback === 'function') initCallback(modal);

  } catch (error) {
    console.error(`[Modal Loader] خطأ في تحميل أو عرض النافذة ${modalId}:`, error);
    Swal.fire("خطأ في التحميل", "حدث خطأ أثناء محاولة تحميل المحتوى. يرجى المحاولة مرة أخرى.", "error");
    if (typeof onCloseCallback === 'function') onCloseCallback();
  }
}

/**
 * @description تفتح نافذة سجل الإشعارات مباشرة في الصفحة الحالية بعد التحقق من تسجيل دخول المستخدم وأهليته لاستقبال الإشعارات.
 * @function showNotificationsModal
 * @returns {Promise&lt;void>} - وعد (Promise) لا يُرجع قيمة عند الاكتمال.
 * @see isUserEligibleForNotifications
 * @see showNotificationsLogModal
 */
async function showNotificationsModal() {
  const loggedInUserJSON = localStorage.getItem("loggedInUser");

  if (loggedInUserJSON) {
    const user = JSON.parse(loggedInUserJSON);

    // التأكد من أن المستخدم مسجل دخوله ومؤهل لرؤية الإشعارات
    if (typeof isUserEligibleForNotifications === 'function' &amp;&amp; isUserEligibleForNotifications(user)) {
      // التأكد من وجود دالة عرض النافذة قبل استدعائها
      if (typeof showNotificationsLogModal === 'function') {
        await showNotificationsLogModal();
      } else {
        console.error('[Utils] الدالة showNotificationsLogModal() غير موجودة. تأكد من تحميل السكريبت الخاص بها.');
      }
    }
  }
}

/**
 * @description دالة مركزية لتوليد HTML لبطاقة المنتج.
 *   تقلل من تكرار الكود وتضمن التناسق في عرض المنتجات عبر التطبيق.
 * @function generateProductCardHTML
 * @param {object} product - كائن المنتج الكامل الذي يحتوي على تفاصيله.
 * @param {string} viewType - نوع العرض الذي يحدد شكل البطاقة ('gallery', 'search', 'seller').
 * @returns {string} - سلسلة HTML التي تمثل بطاقة المنتج.
 * @see SERVICE_CATEGORY_NoPrice_ID
 */
function generateProductCardHTML(product, viewType) {
  // 1. معالجة الصور
  const firstImageName = product.ImageName ? product.ImageName.split(',')[0] : null;
  const imageUrl = firstImageName
    ? `https://pub-e828389e2f1e484c89d8fb652c540c12.r2.dev/${firstImageName}`
    : 'images/placeholder.png'; // صورة افتراضية

  // 2. منطق الخدمات والأسعار
  const isService = product.MainCategory == SERVICE_CATEGORY_NoPrice_ID;
  const price = parseFloat(product.product_price);
  const originalPrice = product.original_price ? parseFloat(product.original_price) : 0;

  let priceHtml = '';
  if (!isService) {
    priceHtml = `&lt;p class="product-price">${price.toFixed(2)} جنيه&lt;/p>`;
    if (originalPrice > price) {
      priceHtml += `&lt;p class="original-price">&lt;del>${originalPrice.toFixed(2)} جنيه&lt;/del>&lt;/p>`;
    }
  }

  // 3. تخصيص الهيكل بناءً على نوع العرض
  let cardClass = '';
  let cardContent = '';
  let cardAttributes = `data-product-key="${product.product_key}"`;

  switch (viewType) {
    case 'gallery':
      cardClass = 'product-card';
      cardContent = `
        &lt;div class="product-image-container">
          &lt;img src="${imageUrl}" alt="${product.productName}" class="product-image" loading="lazy">
        &lt;/div>
        &lt;div class="product-info">
          &lt;h3 class="product-title">${product.productName}&lt;/h3>
          ${priceHtml}
        &lt;/div>
        ${!isService ? '&lt;button class="add-to-cart-btn-gallery">&lt;i class="fas fa-cart-plus">&lt;/i>&lt;/button>' : ''}
      `;
      break;

    case 'search':
      cardClass = 'search-result-item';
      cardContent = `
        &lt;img src="${imageUrl}" alt="${product.productName}" class="search-result-image">
        &lt;div class="search-result-details">
          &lt;h4 class="search-result-title">${product.productName}&lt;/h4>
          ${!isService ? `&lt;p class="search-result-price">${price.toFixed(2)} جنيه&lt;/p>` : ''}
        &lt;/div>
      `;
      break;

    case 'seller':
      cardClass = 'my-products-card';
      const productJson = JSON.stringify(product).replace(/'/g, "&amp;apos;");
      cardAttributes += ` data-main-category="${product.MainCategory || ''}" data-sub-category="${product.SubCategory || ''}"`;
      const imagesHtml = (product.ImageName || '').split(',').filter(Boolean).map(name => 
        `&lt;img src="https://pub-e828389e2f1e484c89d8fb652c540c12.r2.dev/${name}" alt="صورة منتج" onerror="this.style.display='none'">`
      ).join('') || '&lt;span>لا توجد صور&lt;/span>';

      cardContent = `
        &lt;div class="my-products-card-images">${imagesHtml}&lt;/div>
        &lt;div class="my-products-card-details">
          &lt;h4>${product.productName || 'منتج بلا اسم'}&lt;/h4>
          &lt;p>&lt;strong>الوصف:&lt;/strong> ${product.product_description || 'لا يوجد'}&lt;/p>
          ${priceHtml.replace('product-price', '').replace('original-price', '')}
          &lt;p>&lt;strong>الكمية:&lt;/strong> ${product.product_quantity}&lt;/p>
        &lt;/div>
        &lt;div class="my-products-card-actions">
          &lt;button class="button logout-btn-small my-products-edit-btn" data-product='${productJson}'>&lt;i class="fas fa-edit">&lt;/i> تعديل&lt;/button>
          &lt;button class="button delete-btn-small my-products-delete-btn" data-product='${productJson}'>&lt;i class="fas fa-trash-alt">&lt;/i> إزالة&lt;/button>
        &lt;/div>
      `;
      break;
  }

  return `&lt;div class="${cardClass}" ${cardAttributes}>${cardContent}&lt;/div>`;
}

/**
 * @description يولد HTML لصف واحد يمثل منتجًا في سلة المشتريات.
 * @function generateCartItemHTML
 * @param {object} item - كائن يمثل بيانات المنتج في السلة (product details, price, quantity).
 * @returns {string} - سلسلة HTML التي تمثل صف عنصر سلة المشتريات.
 */
function generateCartItemHTML(item) {
  const itemTotal = (item.price * item.quantity).toFixed(2);
  return `
    &lt;div class="purchase-item" data-key="${item.product_key}">
      &lt;img src="${item.image}" alt="${item.productName}" class="purchase-item__image">
      &lt;div class="purchase-item__details">
        &lt;strong>${item.productName}&lt;/strong>
        &lt;p>${item.price} جنيه × ${item.quantity}&lt;/p>
      &lt;/div>
      &lt;div>&lt;strong>${itemTotal} جنيه&lt;/strong>&lt;/div>
      &lt;button class="btn-ghost remove-from-cart-btn" title="إزالة من السلة">&amp;times;&lt;/button>
    &lt;/div>`;
}

/**
 * @description يولد HTML لعنصر واحد في سجل المشتريات.
 * @function generatePurchaseItemHTML
 * @param {object} item - كائن يمثل بيانات المنتج الذي تم شراؤه، بما في ذلك تفاصيل المنتج وحالة الطلب.
 * @returns {string} - سلسلة HTML التي تمثل بطاقة عنصر المشتريات.
 * @see createStatusTimelineHTML
 */
function generatePurchaseItemHTML(item) {
  const firstImage = item.ImageName ? item.ImageName.split(',')[0] : '';
  const imageUrl = firstImage 
    ? `https://pub-e828389e2f1e484c89d8fb652c540c12.r2.dev/${firstImage}`
    : 'images/placeholder.png';

  const isoDateTime = item.created_at.replace(' ', 'T') + 'Z';
  const purchaseDate = new Date(isoDateTime).toLocaleString('ar-EG', {
    year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', hour12: true,
    timeZone: 'Africa/Cairo'
  });

  const itemPrice = parseFloat(item.product_price) || 0;
  const itemQuantity = parseInt(item.quantity, 10) || 0;
  const itemTotal = (itemPrice * itemQuantity).toFixed(2);

  return `
    &lt;div class="purchase-item">
      &lt;img src="${imageUrl}" alt="${item.productName}" class="purchase-item__image">
      &lt;div class="purchase-item__details">
        &lt;strong>${item.productName}&lt;/strong>
        &lt;p>&lt;strong>سعر القطعة:&lt;/strong> ${itemPrice.toFixed(2)} جنيه&lt;/p>
        &lt;p>&lt;strong>الكمية:&lt;/strong> ${item.quantity}&lt;/p>
        &lt;p>&lt;strong>الإجمالي:&lt;/strong> ${itemTotal} جنيه&lt;/p>
        &lt;p>&lt;strong>تاريخ الطلب:&lt;/strong> ${purchaseDate}&lt;/p>
        &lt;div class="purchase-status-timeline">
          ${createStatusTimelineHTML(null, item.status_details, false, 0)}
        &lt;/div>
      &lt;/div>
    &lt;/div>`;
}

/**
 * @description يولد HTML لبطاقة طلب فردي لعرضه في تقرير حركة المبيعات.
 * @function generateSalesMovementItemHTML
 * @param {object} order - كائن يحتوي على بيانات الطلب الكاملة.
 * @param {object} loggedInUser - كائن يحتوي على بيانات المستخدم المسجل دخوله.
 * @param {boolean} isAdmin - قيمة منطقية تشير إلى ما إذا كان المستخدم الحالي مسؤولاً.
 * @returns {string} - سلسلة HTML التي تمثل بطاقة الطلب.
 * @see createStatusTimelineHTML
 * @see ORDER_STATUSES
 */
function generateSalesMovementItemHTML(order, loggedInUser, isAdmin) {
  const userRole = loggedInUser ? loggedInUser.is_seller : 0;
  const isSellerOfThisOrder = userRole === 1 &amp;&amp; order.items.some(item => item.seller_key === loggedInUser.user_key);
  const canEdit = isAdmin || isSellerOfThisOrder || userRole === 2;

  const isoDateTime = order.created_at.replace(' ', 'T') + 'Z';
  const orderDate = new Date(isoDateTime).toLocaleString('ar-EG', {
    year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit', timeZone: 'Africa/Cairo'
  });

  const itemsTable = `&lt;table class="sales-movement-modal__table">&lt;thead>&lt;tr>&lt;th>المنتج&lt;/th>&lt;th>الكمية&lt;/th>&lt;th>سعر القطعة&lt;/th>&lt;th>الإجمالي&lt;/th>&lt;th>عرض&lt;/th>&lt;/tr>&lt;/thead>&lt;tbody>
    ${order.items.map(item => {
      const itemTotal = (item.product_price * item.quantity).toFixed(2);
      const productKey = item.product_key || '';
      return `&lt;tr>
        &lt;td data-label="المنتج">${item.productName}&lt;/td>
        &lt;td data-label="الكمية">${item.quantity}&lt;/td>
        &lt;td data-label="سعر القطعة">${item.product_price.toFixed(2)} ج.م&lt;/td>
        &lt;td data-label="الإجمالي">${itemTotal} ج.م&lt;/td>
        &lt;td data-label="عرض">
          &lt;button class="button icon-btn view-product-details-btn" data-product-key="${productKey}" title="عرض تفاصيل المنتج">&lt;i class="fas fa-eye">&lt;/i>&lt;/button>
        &lt;/td>
      &lt;/tr>`;
    }).join('')}
  &lt;/tbody>&lt;/table>`;

  return `
    &lt;div class="purchase-item">
      &lt;div class="purchase-item-details">
        &lt;p>&lt;strong>رقم الطلب:&lt;/strong> ${order.order_key}&lt;/p>
        ${isAdmin ? `
          &lt;p>&lt;strong>العميل:&lt;/strong> ${order.customer_name}&lt;/p>
          &lt;p>&lt;strong>هاتف العميل:&lt;/strong> ${order.customer_phone}&lt;/p>
          &lt;p>&lt;strong>العنوان:&lt;/strong> ${order.customer_address || 'غير محدد'}&lt;/p>
        ` : ''}
        &lt;p>&lt;strong>تاريخ الطلب:&lt;/strong> ${orderDate}&lt;/p>
        &lt;p>&lt;strong>إجمالي الطلب:&lt;/strong> ${order.total_amount.toFixed(2)} جنيه&lt;/p>
        &lt;div class="purchase-status-timeline">
          ${createStatusTimelineHTML(order.order_key, ORDER_STATUSES.find(s => s.id === order.order_status), canEdit, userRole)}
        &lt;/div>
        &lt;h4>المنتجات:&lt;/h4>
        ${itemsTable}
      &lt;/div>
    &lt;/div>`;
}

/**
 * @description يولد HTML لبطاقة مستخدم فردي لعرضها في لوحة تحكم المسؤول، مع عرض معلومات المستخدم وخيارات الإشعارات وتعديل الدور.
 * @function generateUserCardHTML
 * @param {object} user - كائن يحتوي على بيانات المستخدم.
 * @returns {string} - سلسلة HTML التي تمثل بطاقة المستخدم.
 * @see isUserEligibleForNotifications
 * @see adminPhoneNumbers
 */
function generateUserCardHTML(user) {
  let notificationUI = '';
  if (isUserEligibleForNotifications(user)) {
    notificationUI = user.fcm_token
      ? `&lt;div class="notification-sender">
           &lt;input type="text" placeholder="اكتب رسالتك هنا..." class="notification-input" id="notif-input-${user.user_key}">
           &lt;button class="send-notif-btn" data-token="${user.fcm_token}" data-user-key="${user.user_key}" title="إرسال">&lt;i class="fas fa-paper-plane">&lt;/i>&lt;/button>
         &lt;/div>`
      : '&lt;span class="no-token">مؤهل (لم يسجل الجهاز)&lt;/span>';
  } else {
    notificationUI = '&lt;span class="no-token">غير مؤهل للإشعارات&lt;/span>';
  }

  const isAdmin = adminPhoneNumbers.includes(user.phone);
  const roleUI = isAdmin
    ? `&lt;div class="user-role-static">&lt;i class="fas fa-user-shield">&lt;/i> &lt;span>مسؤول&lt;/span>&lt;/div>`
    : `&lt;select id="role-select-${user.user_key}" class="user-role-select" data-phone="${user.phone}" data-original-state="${user.is_seller}">
         &lt;option value="0" ${user.is_seller === 0 ? 'selected' : ''}>عميل&lt;/option>
         &lt;option value="1" ${user.is_seller === 1 ? 'selected' : ''}>بائع&lt;/option>
         &lt;option value="2" ${user.is_seller === 2 ? 'selected' : ''}>خدمة توصيل&lt;/option>
       &lt;/select>`;

  return `
    &lt;div class="user-card" data-phone="${user.phone}">
      &lt;div class="user-card-header">
        &lt;i class="fas fa-user-circle user-avatar">&lt;/i>
        &lt;div class="user-info">
          &lt;span class="user-name">${user.username || 'غير متوفر'}&lt;/span>
          &lt;span class="user-phone">${user.phone}&lt;/span>
        &lt;/div>
      &lt;/div>
      &lt;div class="user-card-body">
        &lt;div class="user-card-field">
          &lt;label for="role-select-${user.user_key}">دور المستخدم&lt;/label>
          ${roleUI}
        &lt;/div>
        &lt;div class="user-card-field">
          &lt;label>إرسال إشعار&lt;/label>
          ${notificationUI}
        &lt;/div>
      &lt;/div>
    &lt;/div>`;
}

/**
 * @description يولد HTML لعنصر سجل إشعارات فردي لعرضه في واجهة المستخدم، مع تفاصيل مثل العنوان، النص، التاريخ، وحالة الإشعار.
 * @function generateNotificationLogItemHTML
 * @param {object} log - كائن يحتوي على بيانات سجل الإشعار (messageId, type, title, body, timestamp, status, relatedUser, payload, errorMessage).
 * @returns {string} - سلسلة HTML التي تمثل عنصر سجل الإشعارات.
 */
function generateNotificationLogItemHTML(log) {
  const logDate = new Date(log.timestamp).toLocaleString('ar-EG', { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' });
  let iconClass = log.type === 'sent' ? 'fa-paper-plane' : 'fa-inbox';
  let statusClass = log.type;
  let titlePrefix = log.type === 'sent' ? `إلى: ${log.relatedUser.name}` : `من: ${log.relatedUser.name}`;

  if (log.status === 'failed') {
    statusClass += ' failed';
    iconClass = 'fa-exclamation-triangle';
  }

  return `
    &lt;div class="notification-log-item ${statusClass}">
      &lt;i class="fas ${iconClass} notification-log-icon">&lt;/i>
      &lt;div class="notification-log-content">
        &lt;h4>${log.title}&lt;/h4>
        &lt;p>${log.body}&lt;/p>
        &lt;p>&lt;em>${titlePrefix}&lt;/em>&lt;/p>
        ${log.status === 'failed' ? `&lt;p style="color: #e74c3c;">&lt;strong>سبب الفشل:&lt;/strong> ${log.errorMessage || 'غير معروف'}&lt;/p>` : ''}
        &lt;div class="notification-log-timestamp">${logDate}&lt;/div>
      &lt;/div>
    &lt;/div>`;
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#CONNECTION_CHECK_INTERVAL">CONNECTION_CHECK_INTERVAL</a></li><li><a href="global.html#DB_NAME">DB_NAME</a></li><li><a href="global.html#DB_VERSION">DB_VERSION</a></li><li><a href="global.html#NOTIFICATIONS_STORE">NOTIFICATIONS_STORE</a></li><li><a href="global.html#ORDER_STATUSES">ORDER_STATUSES</a></li><li><a href="global.html#ORDER_STATUS_MAP">ORDER_STATUS_MAP</a></li><li><a href="global.html#SERVICE_CATEGORY_NoPrice_ID">SERVICE_CATEGORY_NoPrice_ID</a></li><li><a href="global.html#addNotificationLog">addNotificationLog</a></li><li><a href="global.html#addProduct">addProduct</a></li><li><a href="global.html#addRecord">addRecord</a></li><li><a href="global.html#addToCart">addToCart</a></li><li><a href="global.html#addUpdate">addUpdate</a></li><li><a href="global.html#addUser">addUser</a></li><li><a href="global.html#adminPhoneNumbers">adminPhoneNumbers</a></li><li><a href="global.html#apiFetch">apiFetch</a></li><li><a href="global.html#applyFilters">applyFilters</a></li><li><a href="global.html#askForNotificationPermission">askForNotificationPermission</a></li><li><a href="global.html#baseURL">baseURL</a></li><li><a href="global.html#buildSlider">buildSlider</a></li><li><a href="global.html#checkAdminStatus">checkAdminStatus</a></li><li><a href="global.html#checkAndDisplayNotificationStatus">checkAndDisplayNotificationStatus</a></li><li><a href="global.html#checkImage">checkImage</a></li><li><a href="global.html#checkInternetConnection">checkInternetConnection</a></li><li><a href="global.html#checkLoginStatus">checkLoginStatus</a></li><li><a href="global.html#clearCart">clearCart</a></li><li><a href="global.html#clearError">clearError</a></li><li><a href="global.html#clearNotificationLogs">clearNotificationLogs</a></li><li><a href="global.html#createOrder">createOrder</a></li><li><a href="global.html#createStatusTimelineHTML">createStatusTimelineHTML</a></li><li><a href="global.html#dbPromise">dbPromise</a></li><li><a href="global.html#debounce">debounce</a></li><li><a href="global.html#deleteProduct">deleteProduct</a></li><li><a href="global.html#deleteProductAndImages">deleteProductAndImages</a></li><li><a href="global.html#deleteUser">deleteUser</a></li><li><a href="global.html#displaySearchResults">displaySearchResults</a></li><li><a href="global.html#displayUsers">displayUsers</a></li><li><a href="global.html#fetchUsers">fetchUsers</a></li><li><a href="global.html#filterMyProducts">filterMyProducts</a></li><li><a href="global.html#generateCartItemHTML">generateCartItemHTML</a></li><li><a href="global.html#generateNotificationLogItemHTML">generateNotificationLogItemHTML</a></li><li><a href="global.html#generateOrderKey">generateOrderKey</a></li><li><a href="global.html#generateProductCardHTML">generateProductCardHTML</a></li><li><a href="global.html#generatePurchaseItemHTML">generatePurchaseItemHTML</a></li><li><a href="global.html#generateSalesMovementItemHTML">generateSalesMovementItemHTML</a></li><li><a href="global.html#generateUserCardHTML">generateUserCardHTML</a></li><li><a href="global.html#getCart">getCart</a></li><li><a href="global.html#getCartItemCount">getCartItemCount</a></li><li><a href="global.html#getCartStorageKey">getCartStorageKey</a></li><li><a href="global.html#getCurrentUser">getCurrentUser</a></li><li><a href="global.html#getLatestUpdate">getLatestUpdate</a></li><li><a href="global.html#getNotificationLogs">getNotificationLogs</a></li><li><a href="global.html#getNotificationTokensForOrder">getNotificationTokensForOrder</a></li><li><a href="global.html#getProductByKey">getProductByKey</a></li><li><a href="global.html#getProductsByCategory">getProductsByCategory</a></li><li><a href="global.html#getProductsByUser">getProductsByUser</a></li><li><a href="global.html#getSalesMovement">getSalesMovement</a></li><li><a href="global.html#getUniqueSellerKeys">getUniqueSellerKeys</a></li><li><a href="global.html#getUserByPhone">getUserByPhone</a></li><li><a href="global.html#getUserPurchases">getUserPurchases</a></li><li><a href="global.html#goToSlide">goToSlide</a></li><li><a href="global.html#handleAccountDeletion">handleAccountDeletion</a></li><li><a href="global.html#handleCheckout">handleCheckout</a></li><li><a href="global.html#handleGuestLogin">handleGuestLogin</a></li><li><a href="global.html#handleLoginSuccess">handleLoginSuccess</a></li><li><a href="global.html#handleNewNotification">handleNewNotification</a></li><li><a href="global.html#handleRevokedPermissions">handleRevokedPermissions</a></li><li><a href="global.html#hideText">hideText</a></li><li><a href="global.html#initAdverModule">initAdverModule</a></li><li><a href="global.html#initDB">initDB</a></li><li><a href="global.html#initSearchModal">initSearchModal</a></li><li><a href="global.html#initializeAdminPanel">initializeAdminPanel</a></li><li><a href="global.html#initializeNotifications">initializeNotifications</a></li><li><a href="global.html#initializeUsersAdminLogic">initializeUsersAdminLogic</a></li><li><a href="global.html#isConnectedCache">isConnectedCache</a></li><li><a href="global.html#isUserAdmin">isUserAdmin</a></li><li><a href="global.html#isUserEligibleForNotifications">isUserEligibleForNotifications</a></li><li><a href="global.html#isUserSeller">isUserSeller</a></li><li><a href="global.html#lastConnectionCheck">lastConnectionCheck</a></li><li><a href="global.html#loadAndShowModal">loadAndShowModal</a></li><li><a href="global.html#loadCategories">loadCategories</a></li><li><a href="global.html#loadCategoryFilters">loadCategoryFilters</a></li><li><a href="global.html#loadPageContent">loadPageContent</a></li><li><a href="global.html#loadUsersTable">loadUsersTable</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#normalizeArabicText">normalizeArabicText</a></li><li><a href="global.html#normalizeDigits">normalizeDigits</a></li><li><a href="global.html#offlineToast">offlineToast</a></li><li><a href="global.html#pauseAutoPlay">pauseAutoPlay</a></li><li><a href="global.html#performActualConnectionCheck">performActualConnectionCheck</a></li><li><a href="global.html#performSearch">performSearch</a></li><li><a href="global.html#populateProductDetails">populateProductDetails</a></li><li><a href="global.html#removeFromCart">removeFromCart</a></li><li><a href="global.html#resetAutoPlay">resetAutoPlay</a></li><li><a href="global.html#saveCart">saveCart</a></li><li><a href="global.html#saveNotificationFromAndroid">saveNotificationFromAndroid</a></li><li><a href="global.html#sendNotification">sendNotification</a></li><li><a href="global.html#sendTokenToServer">sendTokenToServer</a></li><li><a href="global.html#setupFCM">setupFCM</a></li><li><a href="global.html#setupModalLogic">setupModalLogic</a></li><li><a href="global.html#showAddProductModal">showAddProductModal</a></li><li><a href="global.html#showAdvertiesmentModal">showAdvertiesmentModal</a></li><li><a href="global.html#showCartModal">showCartModal</a></li><li><a href="global.html#showEditProductModal">showEditProductModal</a></li><li><a href="global.html#showEditProfileModal">showEditProfileModal</a></li><li><a href="global.html#showError">showError</a></li><li><a href="global.html#showFinalText">showFinalText</a></li><li><a href="global.html#showMyProducts">showMyProducts</a></li><li><a href="global.html#showNotificationsLogModal">showNotificationsLogModal</a></li><li><a href="global.html#showNotificationsModal">showNotificationsModal</a></li><li><a href="global.html#showProductDetails">showProductDetails</a></li><li><a href="global.html#showPurchasesModal">showPurchasesModal</a></li><li><a href="global.html#showSalesMovementModal">showSalesMovementModal</a></li><li><a href="global.html#showTextWithZoom">showTextWithZoom</a></li><li><a href="global.html#showUsersAdminModal">showUsersAdminModal</a></li><li><a href="global.html#startAnimationCycle">startAnimationCycle</a></li><li><a href="global.html#startAutoPlay">startAutoPlay</a></li><li><a href="global.html#startPeriodicConnectionCheck">startPeriodicConnectionCheck</a></li><li><a href="global.html#startTaglineCarousel">startTaglineCarousel</a></li><li><a href="global.html#updateCartBadge">updateCartBadge</a></li><li><a href="global.html#updateCartQuantity">updateCartQuantity</a></li><li><a href="global.html#updateOrderStatus">updateOrderStatus</a></li><li><a href="global.html#updateProduct">updateProduct</a></li><li><a href="global.html#updateUser">updateUser</a></li><li><a href="global.html#updateUsers">updateUsers</a></li><li><a href="global.html#updateViewForLoggedInUser">updateViewForLoggedInUser</a></li><li><a href="global.html#verifyUserPassword">verifyUserPassword</a></li><li><a href="global.html#waitForFcmKey">waitForFcmKey</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.5</a> on Sat Nov 22 2025 02:55:09 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
